<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.40" />
  <meta name="author" content="Valentin De Bortoli">
  <meta name="description" content="Phd student in Applied Mathematics">

  
  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  


  

  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Playfair&#43;Display:400,700%7cFauna&#43;One">
  
  <link rel="stylesheet" href="/styles.css">
  

  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="vdb">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="vdb">
  

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="/publication/soul/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="vdb">
  <meta property="og:url" content="/publication/texture_soul/">
  <meta property="og:title" content="Schrodinger bridge
 | vdb">
  <meta property="og:description" content="Schrodinger bridge.">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2017-09-23T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2017-09-23T00:00:00&#43;00:00">
  

  

  <title> Diffusion Schr&ouml;dinger Bridge with Applications to Score-Based Generative Modeling
 | vdb</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">vdb</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#publications">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
          </a>
        </li>

        
        

        
      </ul>

    </div>
  </div>
</nav>

<div class="pub" itemscope itemtype="http://schema.org/CreativeWork">

  


  <div class="container pub-title">
    <h1 itemprop="name">Diffusion Schr&ouml;dinger Bridge with Applications to Score-Based Generative Modeling
</h1>
    <span class="pub-authors" itemprop="author">
      
      De Bortoli, Thornton, Heng, Doucet      
      
    </span>
    <span class="pull-right">
      
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Review%20of%20wavelet-based%20unsupervised%20texture%20segmentation%2c%20advantage%20of%20adaptive%20wavelets&amp;url=%2fpublication%2fwavelet_based_unsupervised_texture_segmentation%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpublication%2fwavelet_based_unsupervised_texture_segmentation%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpublication%2fwavelet_based_unsupervised_texture_segmentation%2f&amp;title=Review%20of%20wavelet-based%20unsupervised%20texture%20segmentation%2c%20advantage%20of%20adaptive%20wavelets"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpublication%2fwavelet_based_unsupervised_texture_segmentation%2f&amp;title=Review%20of%20wavelet-based%20unsupervised%20texture%20segmentation%2c%20advantage%20of%20adaptive%20wavelets"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Review%20of%20wavelet-based%20unsupervised%20texture%20segmentation%2c%20advantage%20of%20adaptive%20wavelets&amp;body=%2fpublication%2fwavelet_based_unsupervised_texture_segmentation%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


    </span>
  </div>

  <div class="article-container">
    <a name="top"></a>
    <ul>
  <li><a href="#generative">What is score-based generative modeling?</a></li>
  <li><a href="#schrodinger">What is a  Schr&ouml;dinger Bridge?</a></li>
  <li><a href="#twodim">Two dimensional examples</a></li>
  <li><a href="#MNIST">MNIST dataset</a></li>
  <li><a href="#celeba_exploration">CelebA exploration</a></li>
  <li><a href="#dataset_interpolation">Dataset interpolation</a></li>
</ul>
    <h3>What is score-based generative modeling?</h3>
    <a name="generative"></a>
    
    In <i>generative modeling</i> we are interested into designing algorithms
    which transform a given distribution $p_{\mathrm{prior}}$ into a given data
    distribution $p_{\mathrm{data}}$. We have access to the data distribution
    only through samples. In the last years, generative modeling has become a
    classical task in machine learning and image processing. There is a flurry
    of frameworks which aim at solving this problem such as Energy-Based models,
    Generative Adversarial Networks, normalizing flows, Variational
    Auto-encoders or diffusion score-matching  techniques. The latter has shown
    great promises in outperforming GANs in term of visual quality, CITE
    DHARIWAL but also can be recast as the discretization of some diffusion
    process and thus is also appealing from a mathematical point of view.

    <br>
    <br>
    Let us recall some of the basics concepts of score-based generative
    modeling, see
    also <a href="http://yang-song.github.io/blog/2021/score/">Yang Song
    blogpost</a> for an introduction.  If we have access to a
    (Ornstein-Ulhenbeck) diffusion $$ \mathrm{d} \mathbf{X}_t = -\alpha
    \mathbf{X}_t \mathrm{d} t + \sqrt{2} \mathrm{d} \mathbf{B}_t \ , \qquad
    \mathbf{X}_0 \sim p_{\mathrm{data}} \ ,$$ with $\alpha > 0$. The process
    $(\mathbf{X}_t)_{t \in [0,T]}$ is interpreted as a <i>noising</i>
    process, perturbing the data distribution $p_{\mathrm{data}}$. We denote
    $p_{\mathrm{prior}}$ the invariant distribution of the noising process, here
    $p_{\mathrm{prior}} = \mathcal{N}(0,1/\alpha)$. If $T > 0$ is large enough
    then the distribution of $\mathbf{X}_T$ is close to $p_{\mathrm{prior}}$ due
    to the ergodicity of the Ornstein-Ulhenbeck process. Then one can
    (approximately) sample from $p_{\mathrm{data}}$ by first sampling from
    $p_{\mathrm{prior}}$ and reversing the dynamics of $(\mathbf{X}_t)_{t \in
    [0,T]}$. Surprisingly this time-reversal operation leads to another
    diffusion process with explicit drift and diffusion matrix [1].  $$
    \mathrm{d} \mathbf{Y}_t = \{\alpha \mathbf{Y}_t + 2 \nabla \log
    p_{T-t}(\mathbf{Y}_{t}) \}\mathrm{d} t + \sqrt{2} \mathrm{d} \mathbf{B}_t \
    , \qquad \mathbf{Y}_0 \sim p_{\mathrm{prior}} \ ,$$ Score-matching
    approaches then discretize this continuous-time dynamics into a Markov
    chain.  $$ Y_{k+1}^\star = Y_k^\star + \gamma_{k+1} \{\alpha Y_k^\star + 2
    \nabla \log p_{T- t_k}(Y_k^\star)\} + \sqrt{2 \gamma_{k+1}} \ ,$$ The Markov
    chain $\{Y_k^\star\}_{k=0}^N$ cannot be computed in practice because we do
    not have access to the logarithmic gradient (Stein score) $\nabla \log
    p_{t}$.  In score-based generative modeling techniques this score is
    approximated by a neural network $s_{\theta^\star}$ solving the following
    variational problem $$\theta^\star = \mathrm{argmin}_\theta \mathrm{E}[\|
    \mathbf{Z}/\sigma_t + s_{\theta}(\mathbf{X}_t) \|^2] \ \, $$ where we recall
    that solutions of the Ornstein-Ulhenbeck process can be written as
    $\mathbf{X}_t = m_t \mathbf{X}_0 + \sigma_t \mathbf{Z}$, with $\mathbf{Z}
    \sim \mathcal{N}(0,1)$, $m_t = \exp[-\alpha t]$ and $\sigma_t^2 = (1 -
    \exp[-2 \alpha t])/\alpha$. The variational formulation for
    $s_{\theta^\star}$ can be obtained using the following formula $$ \nabla
    \log(p_t)(x) = \mathrm{E}[(m_t \mathbf{X}_0 - \mathbf{X}_t)/\sigma_t^2 |
    \mathbf{X}_t=x] = -\mathrm{E}[\mathbf{Z}/\sigma_t | \mathbf{X}_t=x] $$
    Finally the generative model is given by the following Markov chain $$
    Y_{k+1} = Y_k + \gamma_{k+1} \{\alpha Y_k + 2 s_{\theta^\star}(T- t_k,
    Y_k)\} + \sqrt{2 \gamma_{k+1}} \ .$$ These ideas are at the core of every
    score-based generative modeling method.

    <br>
    <p style="text-align:center;">
    <img src="celeba_large.gif" width="40%" /><br> Image extracted
    from <a href="http://yang-song.github.io/blog/2021/score/">Yang Song
    blog</a>. Generative model for  CelebA.
    </p>

    One of the main limitation of score-based generative modeling is that they
    require a large number of step sizes so that the initial forward dynamics is
    close to the distribution $p_{\mathrm{prior}}$ and small enough stepsizes
    so that the neural network approximation holds.

    <br>
    <br> In the next paragraph we introduce our main contribution: <b>Diffusion
    Schr&ouml;dinger Bridge</b>, a new algorithm which generalizes existing
    score-based methods allowing to significantly reduce the number of stepsizes
    needed in order to define score-based generative modeling. This contribution
    also removes the limitation for $p_{\mathrm{prior}}$ to be Gaussian and
    enables future applications in high-dimensional optimal transport.
    
    
    <h3>What is a  Schr&ouml;dinger Bridge?</h3>
    <a name="schrodinger"></a>
    <a href="#top">&#10548; Go back</a> <br>

The Schr&ouml;dinger Bridge (SB) problem is a classical problem appearing in
applied mathematics, optimal control and probability; see [1, 2, 3].  In the
discrete-time setting, it takes the following (dynamic) form. Consider as
reference density $p(x_{0:N})$ describing the process adding noise to the data.
We aim to find $p^\star(x_{0:N})$ such that $p^\star(x_0) = p_{\mathrm{data}}(x_0)$ and
$p^\star(x_N) = p_{\mathrm{prior}}(x_N)$ and minimize the Kullback-Leibler
divergence between $p^\star$ and $p$. More precisely 
$$ p^\star = \mathrm{argmin} \ \{\mathrm{KL}(q|p)\ , \ q_0 = p_{\mathrm{data}} \ , \ q_N = p_{\mathrm{prior}}\}$$
In this work we introduce <b>Diffusion
Schr&ouml;dinger Bridge</b> (DSB), a new algorithm which uses score-matching
approaches [4] to approximate the <i>Iterative Proportional Fitting</i>
algorithm, an iterative method to find the solutions of the SB problem. DSB can
be seen as a refinement of existing score-based generative modeling methods [5,
6]. In the discrete world, the <i>Iterative Proportional Fitting</i> is also
known as the <i>Sinkhorn algorithm</i> [7].

<img src="schrodinger_bridge.png" width="100%" />	    

<h3>Two dimensional examples</h3>
<a name="twodim"></a>
<a href="#top">&#10548; Go back</a> <br>

<p float="left">
  <img src="gif/circle_init.png" width="300" />
  <img src="gif_schro/circle_0123.gif" width="300" /> 
</p>

<p float="left">
  <img src="gif/moon_init.png" width="300" />
  <img src="gif_schro/moon_0123.gif" width="300" /> 
</p>

<p float="left">
  <img src="gif/pinwheel_init.png" width="300" />
  <img src="gif_schro/pinwheel_0123.gif" width="300" /> 
</p>

<p float="left">
  <img src="gif/mixture_init.png" width="300" />
  <img src="gif_schro/mixture_0123.gif" width="300" /> 
</p>

<p float="left">
  <img src="gif/swiss_init.png" width="300" />
  <img src="gif_schro/swiss_0123.gif" width="300" /> 
</p>

<p float="left">
  <img src="gif/scurve_init.png" width="300" />
  <img src="gif_schro/scurve_0123.gif" width="300" /> 
</p>

<p float="left">
  <img src="gif/8gaussians_init.png" width="300" />
  <img src="gif_schro/8gaussians_0123.gif" width="300" /> 
</p>

<p float="left">
  <img src="gif/checker_init.png" width="300" />
  <img src="gif_schro/checker_0123.gif" width="300" /> 
</p>

<h3>MNIST</h3>
<a name="MNIST"></a>
<a href="#top">&#10548; Go back</a> <br>

<img src="gif/mnist_out.gif" />

<h3>CelebA exploration</h3>
<a name="celeba_exploration"></a>
<a href="#top">&#10548; Go back</a> <br>

<h3>Dataset interpolation</h3>
<a name="dataset_interpolation"></a>
<a href="#top">&#10548; Go back</a> <br>


<h3>References</h3>
<br>
[1] Hans F&ouml;llmer
       <i>Random fields and diffusion processes</i>
       In: École d'été de Probabilités de Saint-Flour 1985-1987
<br>
<br>

[2] Christian Léonard 
       <i>A survey of the Schr&ouml;dinger problem and some of its connections with optimal transport</i>
       In: Discrete & Continuous Dynamical Systems-A 2014
<br>
<br>

[3] Yongxin Chen, Tryphon Georgiou and Michele Pavon
       <i>Optimal Transport in Systems and Control</i>
       In: Annual Review of Control, Robotics, and Autonomous Systems 2020
<br>
<br>

[4] Aapo Hyv&auml;rinen and Peter Dayan
       <i>Estimation of non-normalized statistical models by score matching</i>
       In: Journal of Machine Learning Research 2005
<br>
<br>

[5] Yang Song and Stefano Ermon
       <i>Generative modeling by estimating gradients of the data distribution</i>
       In: Advances in Neural Information Processing Systems 2019
<br>
<br>

[6] Jonathan Ho, Ajay Jain and Pieter Abbeel
      <i>Denoising diffusion probabilistic models</i>
       In: Advances in Neural Information Processing Systems 2020






          </div>
        </div>
      </div>
      <div class="col-sm-1"></div>
    </div>
    <div class="visible-xs space-below"></div>

    <div class="space-below"></div>

    <div class="article-style"></div>

    


  </div>
</div>

<div class="container">
  <nav>
  <ul class="pager">
    

    
  </ul>
</nav>

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 De Bortoli &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

